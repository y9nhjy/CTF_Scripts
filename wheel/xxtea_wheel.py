import xxtea
import xtea
import binascii

# s:密文  key:密钥(16字节)
s = 0x5F56781F07CE5F01CE1DADECB3C8E173F20F1B32F59D69CC136CD6A49CE0D9B5C8E0E9B879561F9126004F9E324C6393060E7F18C510A3E6A863A71EC0B5A0295505C7092F676FD3C7C9210C24A3C7215045D05AB5FC1E93C9EB9E3B7D4CEC75EBF056BC86484CB66918AD11856A8A65062A721B0E729E6295FD82067398858E1500BDC403C24309B5EECE5F66EB34C95DB1FBDA9195910CDDB2E4AA944E0815F5CB2FD7A24A6E877320DFCB95CA13B060437FB370A7EB1CD1CB61A3C1FBB45E256CA9799E8B0062125E3804B981454A21ACA8F3286D6D9B768E60C4E51BD55F4515F9B0B82DA72180645CFC7EFDE146DF547F5004B6D59F2F43DE8DAC5EF2E22552B79565670EF9D9DED862BAAE75EBD12854F2C6E73842445CD0E6F241A3C65B545F155DC4E0DA24A606027FE85EC4E3217EAD64973F084DB7BD9889FE4CE01F096ED26711F2086AF6AA05B6B5A9D8BA8F05E8AB0F88798D60AEC47281B37D73948931C0FF2C1E3218FB81EF057CD14F2E6AA4F1B490D8E55D1F18C85B373418B0A01C25DAEB4019B0DDE55B6EF39253DBB27EC4CE972CC0A2BE3BF4D93B7805DF5F7FFF7B77E56803E0FEE0C77B5289031AF47BE77E730F0B972899B21A6AC2F48F332AAD25A64BEA41E7A7C6BFA7852753B1F1F1F18CC9FC61B287D91C8531ADD7FB07BB1CB2385C62175921105F81B356CB2DA0BE1F91E0F66A2D08F6E8C06391B16486C7E1AAC028EFD7DE7D53D37281A35100FBD3408E842D8BF7F2D7B73F6642587A524DCE82E069FED9F3AD07A31E7BD72F1A4A92DDFF970DA910C7C7FC903FF3FFBC4E3CF5972EA7495F49CE5A90168EB2BAE52073409130AB460703E4D4C35D7AD45CB9AEE889A8021B75144E7F7D1405B31D1378DACA30CE845BF978ADEF16172B74DEEABD40AED26D51715B7F10D13093873615D3F7437C2924F90E7F02AA7D5FFBF4410D4A3D5659ADB80B16EBB7D3A675A17C28B302AF686C502C197E792DDA277F9CAB37C59B30CE18B50EEA0C514A4F4A71D85B310DD5E3C37E82663533FFEFC7CEE757CBB759E02841B1D5732B66B5874E2F10CBD32ABD8DCC1F796F2AAF7046EF48626CE2B49F7E0B4B1308EBFB1F6A73BD29136111B9036570E1BEEDD8C22E9EFA939AE2CA16C7BAF77460D9D2555DCD1671E023245A7A61BF46F2E77CF176E39C5B17B4B8479AF97C7B53DB54388589171BE102DD4248A8BA79A9C0CB71C73136306E563E4009AC7C35F64B23D7465ED3869F039BD19AFF368D600D4148A7ABC6E045A9E7A90CBACB68B31DE8E25533C8FA3D67093486394EBB826E8CEB3CA7C983C69706A67A294937C6AFC5FEC1A6B812140277F56C5C9C254937900D8BD75BA9D1D2B0D92A10E6DE56B47865B79963ADCABA39832C3824EFE22D56DC3F137FB292E464C0E4D33F0ED942424FD79053B28E999FF8
s = s.to_bytes(len(hex(s)[2:])//2, 'big')
# 如果密钥是{0x1234,0x2345,0x4567,0x6789}
# 则key = 0x34120000452300006745000089670000.to_bytes(16, 'big')
key = 0x11000000220000003300000044000000.to_bytes(16, 'big')
flag = xxtea.decrypt(s, key, padding=False)
print(flag)
i = int.from_bytes(flag,'big')
print(hex(i))
# flag=binascii.unhexlify(flag)


# 字符串转32位数组 小端序
s = '150E0700312A231C4D463F3869625B54857E7770A19A938CBDB6AFA8D9D2CBC4F5EEE7E0110A03FC2D261F1849423B34655E5750817A736C9D968F88B9B2ABA4D5CEC7C0F1EAE3DC0D06FFF829221B14453E3730615A534C7D766F6899928B84B5AEA7A0D1CAC3BCEDE6DFD80902FBF4251E1710413A332C5D564F4879726B64'
for i in range(int(len(s)/8)):
    print(",0x"+s[i*8+6:i*8+8]+s[i*8+4:i*8+6]+s[i*8+2:i*8+4]+s[i*8:i*8+2],end='')

# 32位大小端互换
# s = '150E0700312A231C4D463F3869625B54857'
# for i in range(int(len(s)/8)):
#     print(s[i*8+6:i*8+8]+s[i*8+4:i*8+6]+s[i*8+2:i*8+4]+s[i*8:i*8+2],end='')

# 16进制转字符串
# s='666c61677b483050335f555f4c316b335f546831355f4355505f30665f5445612e7d0000'.replace(" ", '0')
# for i in range(0,len(s),2):
#     print(chr(int(s[i:i + 2], 16)), end='')
